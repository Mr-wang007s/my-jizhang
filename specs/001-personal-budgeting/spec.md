# Feature Specification: 个人记账与消费趋势统计

**Feature Branch**: `001-personal-budgeting`
**Created**: 2025-11-20
**Status**: Draft
**Input**: User description: "构建一个个人记账项目，支持记录收入、支出、消费趋势统计"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 快速记录日常收支 (Priority: P1)

一名个人用户希望能够随手快速记录每天的收入和支出，以便之后查看当月花销情况。

**Why this priority**: 记账本身是整个功能的核心，没有可用的记录能力，后续列表和趋势统计都无法成立。

**Independent Test**: 只实现本用户故事时，用户仍然可以完成「新增一笔收入/支出并在列表中看到它」的完整闭环。

**Acceptance Scenarios**:

1. **Given** 用户打开应用且尚未记录任何账目，**When** 用户输入金额、选择收支类型、日期和分类并保存，**Then** 系统创建一条新记录并在列表中展示。
2. **Given** 用户已记录多笔账目，**When** 用户再次新增一笔支出，**Then** 新记录出现在列表顶部或明显位置，且金额、类型、日期、分类与输入一致。

---

### User Story 2 - 查看账单列表与汇总 (Priority: P2)

用户希望能够按时间范围查看所有记账记录，并快速看到该时间段的总收入、总支出和结余。

**Why this priority**: 没有清晰的列表和汇总，用户难以感知整体收支状况，记账价值降低。

**Independent Test**: 只实现本用户故事（在已有记录能力的前提下），用户可以通过筛选查看某段时间内的收支明细和汇总信息。

**Acceptance Scenarios**:

1. **Given** 用户已经记录了过去一个月的多笔账目，**When** 用户选择「本月」时间范围，**Then** 列表仅展示本月内的记录，总收入/总支出/结余按本月记录计算。
2. **Given** 用户选择自定义起止日期，**When** 用户应用筛选条件，**Then** 列表和汇总数据同步更新为该时间范围内的数据。

---

### User Story 3 - 查看消费趋势统计 (Priority: P3)

用户希望能够看到自己在一段时间内的消费趋势，例如每月支出变化曲线、按分类统计的支出占比，从而调整消费习惯。

**Why this priority**: 趋势分析帮助用户从长期视角理解消费行为，是记账的进阶价值。

**Independent Test**: 只实现本用户故事（在已有记录和汇总能力的前提下），用户可以不看具体明细，仅通过趋势视图理解自己近期消费情况。

**Acceptance Scenarios**:

1. **Given** 用户有至少 3 个月的历史支出记录，**When** 用户打开消费趋势视图，**Then** 系统展示按月份汇总的支出趋势（如折线图或柱状图），且每个月的金额与列表/汇总数据一致。
2. **Given** 用户的支出记录包含多个不同分类，**When** 用户查看按分类的支出统计，**Then** 系统展示各分类占总支出的比例，并支持识别出支出占比最高的几个分类。

---

### Edge Cases

- 当某个时间范围内没有任何记账条目时，列表应清晰提示「暂无数据」，统计视图应显示为 0 或空状态而不是错误或空白页面。
- 当用户录入极端金额（如 0、非常小或非常大的数值）时，系统应保留记录并在汇总/统计中正确计算。
- 当用户在短时间内连续新增或编辑多条记录时，列表和统计结果应保持一致，不出现遗漏或重复计算。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须允许用户记录收入和支出条目，包括金额、类型（收入/支出）、日期、分类和备注等字段。
- **FR-002**: 系统必须允许用户按时间范围和类型浏览记账列表，并支持按时间倒序查看最近记录。
- **FR-003**: 系统必须为指定时间范围汇总总收入、总支出和结余，并在界面上清晰展示。
- **FR-004**: 系统必须提供消费趋势统计视图，例如按月份或日期展示支出趋势，以及按分类统计支出占比。
- **FR-005**: 系统必须允许用户修改和删除已记录条目，并在修改后即时更新相关汇总和统计结果。

假设与范围（记录在此以便后续澄清）：

- 假设该功能面向单用户个人使用，不涉及多人共享账本或权限控制。
- 假设暂不处理多币种，所有金额使用同一币种展示。
- 假设历史数据长期保留，除非用户主动删除记录。

### Key Entities *(include if feature involves data)*

- **记账条目（Transaction）**: 表示一笔收入或支出，包含金额、类型（收入/支出）、日期、分类、备注等属性，用于在列表和统计中进行计算。
- **分类（Category）**: 表示收入或支出的类别（如工资、餐饮、交通等），用于在列表筛选和统计视图中对记录进行分组。
- **统计视图配置（Analytics View）**: 抽象出用于展示消费趋势和汇总信息的视图配置，例如时间粒度（按日/周/月）、统计维度（按时间/分类）。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 至少 80% 的目标用户能够在首次使用时，在 30 秒内完成「记录一笔支出」流程（从打开应用到保存成功）。
- **SC-002**: 在一个月内包含最多 1000 条记录的情况下，用户打开当月账单列表或切换时间/类型筛选时，等待时间不超过 2 秒。
- **SC-003**: 与本功能相关的已知严重缺陷（P0/P1）在对外发布前为 0。
- **SC-004**: 与「新增/编辑/删除记账」「查看账单列表」「查看消费趋势」三条主路径相关的测试用例在上线前均执行通过。
- **SC-005**: 在至少 5 名体验用户的小规模试用中，80% 以上用户反馈「记账流程简单易懂」「消费趋势展示清晰」。
